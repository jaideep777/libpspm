<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="libpspm">
<title>Setting up your own PSPM â€¢ libpspm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Setting up your own PSPM">
<meta property="og:description" content="libpspm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">libpspm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
    Home
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--tutorials">
    <span class="fa fa-book fa-lg"></span>
     
    Tutorials
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--tutorials">
    <a class="dropdown-item" href="../articles/what_is_pspm.html">What is a PSPM?</a>
    <a class="dropdown-item" href="../articles/defining_model_basic.html">Setting up your PSPM</a>
    <a class="dropdown-item" href="../articles/size_integral.html">Computing state integrals</a>
    <a class="dropdown-item" href="../articles/demo_red.html">Demo: RED model</a>
    <a class="dropdown-item" href="../articles/defining_model_advanced.html">Advanced usage</a>
    <a class="dropdown-item" href="../articles/demo_daphnia.html">Demo: Daphnia model</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--developer">
    <span class="fa fa-user-secret"></span>
     
    Developer
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--developer">
    <a class="dropdown-item" href="../articles/size_integral_dev.html">Size integrals</a>
    <a class="dropdown-item" href="../articles/ode_flow_dev.html">Logic flowchart</a>
    <a class="dropdown-item" href="../articles/faq_dev.html">FAQs for developers</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../html/index.html">
    <span class="fa fa-code fa-lg"></span>
     
    API
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../articles/news.html">
    <span class="fa fa-newspaper fa-lg"></span>
     
    News
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jaideep777/libpspm">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Setting up your own PSPM</h1>
                        <h4 data-toc-skip class="author">Jaideep
Joshi</h4>
            
            <h4 data-toc-skip class="date">11 March 2022</h4>
      
      
      <div class="d-none name"><code>defining_model_basic.Rmd</code></div>
    </div>

    
    
<p>The first step in simulating a PSPM with libpspm is to define the
behaviour of individuals and the environment. At a minimum, setting up
your model requires defining three things:</p>
<ol style="list-style-type: decimal">
<li><p>How the environment should be computed from the size distribution
of individuals <span class="math inline">\(u(x)\)</span> and time <span class="math inline">\(t\)</span>: <span class="math inline">\(E(u(x),t)\)</span>.</p></li>
<li><p>The three demographic rates of individuals (growth rate <span class="math inline">\(g\)</span>, mortality rate <span class="math inline">\(\mu\)</span>, and fecundity rate <span class="math inline">\(\beta\)</span>) as functions of their
physiological state <span class="math inline">\(x\)</span>, time <span class="math inline">\(t\)</span>, and the environment <span class="math inline">\(E\)</span>.</p></li>
<li><p>A function to specify the initial condition.</p></li>
</ol>
<div class="section level3">
<h3 id="defining-the-environment">Defining the environment<a class="anchor" aria-label="anchor" href="#defining-the-environment"></a>
</h3>
<p>libpspm provides a base class for the environment called
<code>EnvironmentBase</code>. You must inherit it to define your own
environment class, and override the <code>computeEnv</code> function.
For examle, let us call it <code>MyEnvironment</code>, and define it as
follows.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyEnvironment <span class="op">:</span> <span class="kw">public</span> EnvironmentBase<span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span><span class="op">:</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span> computeEnv<span class="op">(</span><span class="dt">double</span> t<span class="op">,</span> Solver <span class="op">*</span> S<span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;::</span>iterator s<span class="op">,</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;::</span>iterator dsdt<span class="op">){</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>      <span class="co">// compute the environment from cohorts here</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p>Note that <code>computeEnv</code> overrides the function by the same
name in <code>EnvironmentBase</code> and thus must have exactly the same
arguments and return type as defined here.</p>
</div>
<div class="section level3">
<h3 id="defining-individuals">Defining individuals<a class="anchor" aria-label="anchor" href="#defining-individuals"></a>
</h3>
<p>libpspm provides a base class for individuals called
<code>IndividualBase</code>. You can inherit it to define your own
individual class, and override the functions to calculate the
demographic rates, as follows. Note that these functions have an
argument of type <code>void*</code>, which is used by the
<code>Solver</code> to pass a pointer to the Environment object. Before
accessing it, it needs to be cast to your own environment type, as shown
in the functions below.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyIndividual <span class="op">:</span> <span class="kw">public</span> IndividualBase<span class="op">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span><span class="op">:</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> growthRate<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> t<span class="op">,</span> <span class="dt">void</span> <span class="op">*</span> _env<span class="op">){</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>      MyEnvironment <span class="op">*</span> env <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span>MyEnvironment<span class="op">*&gt;(</span>_env<span class="op">);</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      <span class="co">// return the growth rate as a function of </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>      <span class="co">// the physiological variable x, time t, and environment _env</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> mortalityRate<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> t<span class="op">,</span> <span class="dt">void</span> <span class="op">*</span> _env<span class="op">){</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    MyEnvironment <span class="op">*</span> env <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span>MyEnvironment<span class="op">*&gt;(</span>_env<span class="op">);</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// return the mortality rate as a function of </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// the physiological variable x, time t, and environment _env</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> birthRate<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">double</span> t<span class="op">,</span> <span class="dt">void</span> <span class="op">*</span> _env<span class="op">){</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    MyEnvironment <span class="op">*</span> env <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span>MyEnvironment<span class="op">*&gt;(</span>_env<span class="op">);</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// return the fecundity (birth rate) as a function of </span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// the physiological variable x, time t, and environment _env</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p>Note that these functions override the functions by the same names in
<code>IndividualBase</code> and thus must have exactly the same
arguments and return types as specified here. It is possible to define
your Individual class without inheriting from
<code>IndividualBase</code>: see <a href="defining_model_advanced.html">advanced usage</a>.</p>
</div>
<div class="section level3">
<h3 id="defining-the-initial-condition">Defining the initial condition<a class="anchor" aria-label="anchor" href="#defining-the-initial-condition"></a>
</h3>
<p>During initialization, the <code>Solver</code> calls the
<code>init_density()</code> function for each cohort. This function must
be defined in your individual class, like so:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyIndividual <span class="op">:</span> <span class="kw">public</span> IndividualBase<span class="op">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span><span class="op">:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> init_density<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span> <span class="dt">void</span> <span class="op">*</span> _env<span class="op">,</span> <span class="dt">double</span> bf<span class="op">){</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      MyEnvironment <span class="op">*</span> env <span class="op">=</span> <span class="kw">static_cast</span><span class="op">&lt;</span>MyEnvironment<span class="op">*&gt;(</span>_env<span class="op">);</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>      <span class="co">// return the initial density (initial condition) as a function of </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      <span class="co">// the physiological variable x, environment _env, and input flux of newborns bf</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">// other functions</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-a-species-of-individuals">Creating a species of individuals<a class="anchor" aria-label="anchor" href="#creating-a-species-of-individuals"></a>
</h3>
<p>Once you have defined the individual class, the next step is to
create a species of individuals that can be simulated by the Solver.
libpspm provides a templated Species class for this purpose, which can
be used to create a species as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Species<span class="op">&lt;</span>MyIndividual<span class="op">&gt;</span> spp<span class="op">;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-an-environment-object">Creating an Environment object<a class="anchor" aria-label="anchor" href="#creating-an-environment-object"></a>
</h3>
<p>You also need to instantiate an environment object which the PSPM
Solver can use, as follows</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>MyEnvironment E<span class="op">;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-a-pspm-solver">Creating a PSPM solver<a class="anchor" aria-label="anchor" href="#creating-a-pspm-solver"></a>
</h3>
<p>The core task of simulating your model is performed by a PSPM
<code>Solver</code> provided by libpspm. A solver can be created by
specifying the PSPM method and the ODE solver method. For example, if we
want to use the EBT method with an LSODA ODE solver, we can write</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Solver S<span class="op">(</span>SOLVER_EBT<span class="op">,</span> <span class="st">"lsoda"</span><span class="op">)</span></span></code></pre></div>
<p>The PSPM method can be one of the following: <code>SOLVER_FMU</code>,
<code>SOLVER_IFMU</code>, <code>SOVLER_EBT</code>, or
<code>SOLVER_CM</code>.</p>
<p>The ODE stepper can be either <code>"rk45ck"</code> or
<code>"lsoda"</code>.</p>
</div>
<div class="section level3">
<h3 id="adding-the-species-and-the-environment-to-the-solver">Adding the species and the environment to the solver<a class="anchor" aria-label="anchor" href="#adding-the-species-and-the-environment-to-the-solver"></a>
</h3>
<p>We then add our species and the environment object to the solver, so
that they can be simulated. While adding a species to the solver, a
number of details regarding the i-state must be specified, as described
below.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>S<span class="op">.</span>setEnv<span class="op">(</span>E<span class="op">);</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>S<span class="op">.</span>addSpecies<span class="op">(</span><span class="dv">25</span><span class="op">,</span>     <span class="co">//  the (initial) number of cohorts to simulate</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>             <span class="dv">1</span><span class="op">,</span>      <span class="co">//  the i-state at birth</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>             <span class="fl">1e4</span><span class="op">,</span>    <span class="co">//  the maximum i-state value</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>             <span class="kw">false</span><span class="op">,</span>  <span class="co">//  whether the i-state axis should be on log scale</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>             <span class="op">&amp;</span>spp<span class="op">,</span>   <span class="co">//  a pointer to the species object </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>             <span class="dv">0</span><span class="op">,</span>      <span class="co">//  number of extra x-linked i-state variables</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>             <span class="dv">1</span>       <span class="co">//  the input flux of newborns</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>S<span class="op">.</span>resetState<span class="op">(</span><span class="dv">0</span><span class="op">);</span>     <span class="co">//  argument is the start time</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>S<span class="op">.</span>initialize<span class="op">();</span>      <span class="co">//  compute the initial condition</span></span></code></pre></div>
<p>With this, we are set to run the simulation.</p>
</div>
<div class="section level3">
<h3 id="simulating-the-pspm">Simulating the PSPM<a class="anchor" aria-label="anchor" href="#simulating-the-pspm"></a>
</h3>
<p>To simulate the PSPM, the solver provides a <code>step_to()</code>
function. For example, to simulate 100 time units, do</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>S<span class="op">.</span>step_to<span class="op">(</span><span class="dv">100</span><span class="op">);</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="getting-system-properties-from-the-solver">Getting system properties from the solver<a class="anchor" aria-label="anchor" href="#getting-system-properties-from-the-solver"></a>
</h3>
<p>After simulating the PSPM, we are interested in computing emergent
system properties. The solver provides two functions to get the state
density distribution and the output flux of newborns:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>S<span class="op">.</span>newborns_out<span class="op">(</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>S<span class="op">.</span>getDensitySpecies_EBT<span class="op">(</span>breaks<span class="op">);</span></span></code></pre></div>
<p>Other emergent properties can be calculated using the state integral
function as described in the next tutorial.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://jaideep777.github.io" class="external-link">Jaideep
Joshi</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
